{"ast":null,"code":"var _jsxFileName = \"/Users/krishna/Documents/Projects/sheep-game/src/components/Minting.jsx\",\n  _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport WoodButton from \"./WoodButton\";\nimport Container from \"./Container\";\nimport MintProgress from \"./MintProgress\";\nimport LoadingModal from \"./LoadingModal\";\nimport OutcomeModal from \"./OutcomeModal\";\nimport EthereumInteraction from \"./EthereumInteraction\";\nimport { mint, mintWithJoe, mintWithTractor, parseMint } from \"../utils/woolf\";\nimport { approve } from \"../utils/erc20\";\n// import { mint, parseMint, tokenURI, isInvalidWoolf } from '../utils/woolf'\nimport { watchTransaction } from \"../utils/ethereum\";\n// import { decodeTokenURI, isSheep } from '../utils/uri'\nimport { decodeTokenURI } from \"../utils/uri\";\n// import MintNStakeModal from './MintNStakeModal'\nimport { utils, BigNumber } from \"ethers\";\n\n// todo: change these prices in woolf.js as well\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PLACEHOLDER = \"data:application/json;base64,eyJuYW1lIjogIldvbGYgIzI5IiwgImRlc2NyaXB0aW9uIjogIlRob3VzYW5kcyBvZiBTaGVlcCBhbmQgV29sdmVzIGNvbXBldGUgb24gYSBmYXJtIGluIHRoZSBtZXRhdmVyc2UuIEEgdGVtcHRpbmcgcHJpemUgb2YgJFdPT0wgYXdhaXRzLCB3aXRoIGRlYWRseSBoaWdoIHN0YWtlcy4gQWxsIHRoZSBtZXRhZGF0YSBhbmQgaW1hZ2VzIGFyZSBnZW5lcmF0ZWQgYW5kIHN0b3JlZCAxMDAlIG9uLWNoYWluLiBObyBJUEZTLiBOTyBBUEkuIEp1c3QgdGhlIEF2YWxhbmNoZSBibG9ja2NoYWluLiIsICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBEOTRiV3dnZG1WeWMybHZiajBpTVM0d0lpQmxibU52WkdsdVp6MGlhWE52TFRnNE5Ua3RNU0kvUGcwS1BDRXRMU0JIWlc1bGNtRjBiM0k2SUVGa2IySmxJRWxzYkhWemRISmhkRzl5SURFNExqRXVNU3dnVTFaSElFVjRjRzl5ZENCUWJIVm5MVWx1SUM0Z1UxWkhJRlpsY25OcGIyNDZJRFl1TURBZ1FuVnBiR1FnTUNrZ0lDMHRQZzBLUEhOMlp5QjJaWEp6YVc5dVBTSXhMakVpSUdsa1BTSkRZWEJoWHpFaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJZ2VHMXNibk02ZUd4cGJtczlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1RrdmVHeHBibXNpSUhnOUlqQndlQ0lnZVQwaU1IQjRJZzBLQ1NCMmFXVjNRbTk0UFNJd0lEQWdNeklnTXpJaUlITjBlV3hsUFNKbGJtRmliR1V0WW1GamEyZHliM1Z1WkRwdVpYY2dNQ0F3SURNeUlETXlPeUlnZUcxc09uTndZV05sUFNKd2NtVnpaWEoyWlNJK0RRbzhaejROQ2drOFp5QnBaRDBpY1hWbGMzUnBiMjVmZURWR1gyMWhjbXNpUGcwS0NRazhaejROQ2drSkNUeHdZWFJvSUhOMGVXeGxQU0ptYVd4c09pTXdNekF4TURRN0lpQmtQU0pOTVRjdU5pd3pNR013TERFdU1UQXlMVEF1T0RrMUxESXRNaXd5Y3kweUxUQXVPRGs0TFRJdE1tTXdMVEV1TVRBNUxEQXVPRGsxTFRJc01pMHlVekUzTGpZc01qZ3VPRGt4TERFM0xqWXNNekI2SWk4K0RRb0pDUWs4Y0dGMGFDQnpkSGxzWlQwaVptbHNiRG9qTURNd01UQTBPeUlnWkQwaVRURTFMalkzTml3eU5TNDVOemRqTFRFdU16TTJMREF0TWk0MU9TMHdMalV5TXkwekxqVXpOUzB4TGpRMk9XTXRNQzQ1TkRVdE1TNHhNRFV0TVM0ME5qVXRNaTR6TlRrdE1TNDBOalV0TXk0Mk9UVU5DZ2tKQ1Fsek1DNDFNaTB5TGpVNUxERXVORFkxTFRNdU16Y3hiRFl1TmpnNExUWXVOamc0UXpFNUxqVTROQ3c1TGprNU5pd3lNQ3c0TGprNU1pd3lNQ3czTGpreU5tTXdMVEV1TURjdE1DNDBNVFl0TWk0d056UXRNUzR4TnpJdE1pNDRNamdOQ2drSkNRbGpMVEV1TlRVNUxURXVOVFU1TFRRdU1EazJMVEV1TlRZeUxUVXVOalUwTERCRE1USXVOREUyTERVdU9EVXlMREV5TERZdU9EVTFMREV5TERjdU9USTJTRGhqTUMweUxqRXpOeXd3TGpnek5DMDBMakUwT0N3eUxqTTBPQzAxTGpZMkRRb0pDUWtKWXpNdU1ESXRNeTR3TWpNc09DNHlPRFV0TXk0d01pd3hNUzR6TURrc01DNHdNRFJETWpNdU1UWTRMRE11TnpjM0xESTBMRFV1TnpnMUxESTBMRGN1T1RJMll6QXNNaTR4TXpjdE1DNDRNeklzTkM0eE5EVXRNaTR6TkRRc05TNDJOVFpzTFRZdU5qZzRMRFl1TlRJekRRb0pDUWtKWXkwd0xqTTRPU3d3TGpNNU1TMHdMak00T1N3eExqQXlNeXd3TERFdU5ERTBZekF1TXpreExEQXVNemt4TERFdU1ESXpMREF1TXpreExERXVOREUwTERCak1DNHlOVFF0TUM0eU5UZ3NNQzR5T1RNdE1DNDFOVFVzTUM0eU9UTXRNQzQzTVRGb05BMEtDUWtKQ1dNd0xERXVNek0yTFRBdU5USXNNaTQxT1RRdE1TNDBOalVzTXk0Mk9UbERNVGd1TWpZMkxESTFMalExTXl3eE55NHdNVElzTWpVdU9UYzNMREUxTGpZM05pd3lOUzQ1TnpkTU1UVXVOamMyTERJMUxqazNOM29pTHo0TkNna0pQQzluUGcwS0NUd3ZaejROQ2p3dlp6NE5DanhuUGcwS1BDOW5QZzBLUEdjK0RRbzhMMmMrRFFvOFp6NE5Dand2Wno0TkNqeG5QZzBLUEM5blBnMEtQR2MrRFFvOEwyYytEUW84Wno0TkNqd3ZaejROQ2p4blBnMEtQQzluUGcwS1BHYytEUW84TDJjK0RRbzhaejROQ2p3dlp6NE5DanhuUGcwS1BDOW5QZzBLUEdjK0RRbzhMMmMrRFFvOFp6NE5Dand2Wno0TkNqeG5QZzBLUEM5blBnMEtQR2MrRFFvOEwyYytEUW84Wno0TkNqd3ZaejROQ2p3dmMzWm5QZzBLIiwgImF0dHJpYnV0ZXMiOlt7InRyYWl0X3R5cGUiOiJGdXIiLCJ2YWx1ZSI6IkdyYXkifSx7InRyYWl0X3R5cGUiOiJIZWFkIiwidmFsdWUiOiJCZXRhIn0seyJ0cmFpdF90eXBlIjoiRXllcyIsInZhbHVlIjoiQ2xvc2VkIn0seyJ0cmFpdF90eXBlIjoiTW91dGgiLCJ2YWx1ZSI6IlNtaXJrIn0seyJ0cmFpdF90eXBlIjoiTmVjayIsInZhbHVlIjoiVGllIn0seyJ0cmFpdF90eXBlIjoiQWxwaGEgU2NvcmUiLCJ2YWx1ZSI6IjcifSx7InRyYWl0X3R5cGUiOiJHZW5lcmF0aW9uIiwidmFsdWUiOiJHZW4gMCJ9LHsidHJhaXRfdHlwZSI6IlR5cGUiLCJ2YWx1ZSI6IldvbGYifV19\";\nconst MINT_PRICE = \"2\";\nconst TRACTOR_PRICE = \"32000\";\nconst JOE_PRICE = \"62\";\nconst PAY_WITH = {\n  AVAX: \"AVAX\",\n  TRACTOR: \"TRACTOR\",\n  JOE: \"JOE\"\n};\nconst paymentOptions = [{\n  id: PAY_WITH.AVAX,\n  title: \"AVAX\"\n}, {\n  id: PAY_WITH.TRACTOR,\n  title: \"TRACTOR\"\n}, {\n  id: PAY_WITH.JOE,\n  title: \"JOE\"\n}];\nconst Minting = ({\n  wallet,\n  chain,\n  stats,\n  reload,\n  woolBalance\n}) => {\n  _s();\n  const [amount, setAmount] = useState(1);\n  const [loading, setLoading] = useState(false);\n  const [transacting, setTransacting] = useState(false);\n  const [error, setError] = useState(null);\n  const [outcomes, setOutcomes] = useState([]);\n  // const [mintingAndStaking, setMintingAndStaking] = useState(false)\n  const [, setMintingAndStaking] = useState(false);\n  const [paymentToken, setPaymentToken] = useState(PAY_WITH.AVAX);\n  const onPaymentToken = e => {\n    setPaymentToken(e.target.id);\n  };\n  const onMint = async stake => {\n    setLoading(true);\n    setError(null);\n    try {\n      let hash;\n      if (paymentToken === PAY_WITH.AVAX) {\n        hash = (await mint(stake, amount, requiresEth())).hash;\n      } else if (paymentToken === PAY_WITH.TRACTOR) {\n        await approve(\"0x542fa0b261503333b90fe60c78f2beed16b7b7fd\", process.env.REACT_APP_WOOLF);\n        hash = (await mintWithTractor(amount)).hash;\n      } else if (paymentToken === PAY_WITH.JOE) {\n        await approve(\"0x6e84a6216ea6dacc71ee8e6b0a5b7322eebc0fdd\", process.env.REACT_APP_WOOLF);\n        hash = (await mintWithJoe(amount)).hash;\n      } else {\n        return;\n      }\n      setTransacting(true);\n      setMintingAndStaking(false);\n      watchTransaction(hash, (receipt, success) => {\n        if (!success) {\n          setLoading(false);\n          setTransacting(false);\n          return setError(\"Mint failed. Check transaction.\");\n        }\n        const results = parseMint(stake, receipt);\n        setTimeout(async () => {\n          await presentOutcomes(results);\n          setLoading(false);\n          setTransacting(false);\n        }, 2000);\n      });\n    } catch (e) {\n      console.log(e);\n      setLoading(false);\n    }\n  };\n\n  // const delay = (time) => {\n  //   return new Promise(res => setTimeout(res, time))\n  // }\n\n  // const getWoolf = async (tokenId) => {\n  //   try {\n  //     let u = await tokenURI(tokenId)\n  //     while (isInvalidWoolf(decodeTokenURI(u))) {\n  //       console.log('RETRYING')\n  //       await delay(1000)\n  //       u = await tokenURI(tokenId)\n  //     }\n  //     return u\n  //   } catch (e) {\n  //     console.log('READ FAILED. RETRYING')\n  //     return getWoolf(tokenId)\n  //   }\n  // }\n\n  const presentOutcomes = async results => {\n    const o = [];\n    for (let i in results) {\n      // const { tokenId, recipient, stake } = results[i]\n      const {\n        tokenId,\n        recipient\n      } = results[i];\n\n      // let u = await getWoolf(tokenId)\n      let u = PLACEHOLDER;\n      const stolen = recipient.toLowerCase() !== wallet.toLowerCase();\n      if (stolen) {\n        const shortRecipient = `${recipient.slice(0, 6)}...${recipient.slice(-4)}`;\n        o.push({\n          message: `You minted a sheep or a woolf #${tokenId.toString()} BUT...`,\n          source: decodeTokenURI(u).image,\n          link: \"\",\n          linkMessage: \"\"\n        }, {\n          message: `It was stolen by a Wolf! It's now owned by ${shortRecipient}`,\n          source: \"/images/mint-stolen.gif\"\n        });\n      } else {\n        // * og\n        // o.push({\n        //   message:`You arrived safely at home with ${isSheep(u) ? 'Sheep' : 'Wolf'} #${tokenId.toString()}...`,\n        //   source: decodeTokenURI(u).image,\n        //   link:`${process.env.REACT_APP_OPENSEA}/${process.env.REACT_APP_WOOLF}/${tokenId.toString()}`,\n        //   linkMessage:'View on OpenSea'\n        // })\n        o.push({\n          message: `You arrived safely at home with a sheep or a woolf #${tokenId.toString()}...`,\n          source: decodeTokenURI(u).image,\n          link: \"\",\n          linkMessage: \"\"\n        });\n      }\n    }\n    setOutcomes(o);\n  };\n  const totalMinted = () => {\n    if (!stats) return 0;\n    // return parseInt(stats.sheepMinted) + parseInt(stats.wolvesMinted)\n    return parseInt(stats.totalSupply);\n  };\n  const maxTokens = () => {\n    if (!stats) return 50000;\n    return stats.maxTokens;\n  };\n  const requiresEth = () => {\n    if (!stats) return true;\n    return totalMinted() < parseInt(stats.maxTokens) / 5;\n  };\n  const ethCost = () => {\n    return utils.formatUnits(utils.parseUnits(MINT_PRICE, \"gwei\").mul(BigNumber.from(amount)), \"gwei\") + \" AVAX\";\n  };\n  const tractorCost = () => {\n    return utils.formatUnits(utils.parseUnits(TRACTOR_PRICE, \"gwei\").mul(BigNumber.from(amount)), \"gwei\") + \" TRACTOR\";\n  };\n  const joeCost = () => {\n    return utils.formatUnits(utils.parseUnits(JOE_PRICE, \"ether\").mul(BigNumber.from(amount)), \"ether\") + \" JOE\";\n  };\n  const woolCost = tokenId => {\n    if (!stats) return 0;\n    let maxTokens = parseInt(stats.maxTokens);\n    if (tokenId <= maxTokens * 2 / 5) return 20000;\n    if (tokenId <= maxTokens * 4 / 5) return 40000;\n    return 80000;\n  };\n  const totalWoolCost = () => {\n    if (!stats) return 0;\n    let total = 0;\n    let currentId = totalMinted();\n    for (let i = 1; i <= amount; i++) {\n      total += woolCost(currentId + i);\n    }\n    return total;\n  };\n  const preCheck = () => {\n    if (requiresEth()) return undefined;\n    if (!woolBalance || woolBalance === \"?\") return \"Insufficient $aWOOL\";\n    if (utils.parseUnits(\"\" + totalWoolCost(), \"gwei\").gt(woolBalance)) return \"Insufficient $aWOOL\";\n    return undefined;\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col items-center font-pixel gap-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"subtitle mt-5\",\n        children: \"MINTING\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(MintProgress, {\n        minted: totalMinted(),\n        maxTokens: maxTokens()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }, this), totalMinted() >= maxTokens() ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-red text-2xl\",\n        children: \"Sold out!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(EthereumInteraction, {\n        wallet: wallet,\n        chain: chain,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center items-center gap-2\",\n          style: {\n            height: \"50px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-console text-lg pt-2 mr-3\",\n            children: \"Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/arrow-down.svg\",\n            alt: \"decrease\",\n            className: \"cursor-pointer\",\n            style: {\n              minWidth: \"25px\"\n            },\n            onClick: () => {\n              setAmount(Math.max(1, amount - 1));\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-console text-red text-3xl pt-2\",\n            children: amount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/arrow-up.svg\",\n            alt: \"decrease\",\n            className: \"cursor-pointer\",\n            style: {\n              minWidth: \"25px\"\n            },\n            onClick: () => {\n              setAmount(Math.min(10, amount + 1));\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-2\",\n          children: [\"Cost:\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-red\",\n            children: requiresEth() ? ethCost() : `${totalWoolCost()} $aWOOL`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 29\n          }, this), requiresEth() && /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-red\",\n              children: [\" \", tractorCost(), \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 37\n            }, this), \"\\xA0 or\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 33\n          }, this), requiresEth() && /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-red\",\n              children: [\" \", joeCost(), \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 25\n        }, this), preCheck() ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red text-2xl\",\n          children: preCheck()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex xl:flex-row flex-col justify-center items-center gap-5\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col justify-center items-center\",\n            children: [/*#__PURE__*/_jsxDEV(WoodButton, {\n              width: 250,\n              height: 40,\n              title: \"MINT\",\n              fontSize: 20,\n              loading: loading,\n              onClick: () => {\n                onMint(false);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2\",\n              style: {\n                height: \"20px\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 29\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-red font-console\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 35\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(LoadingModal, {\n      loadingScenes: [{\n        message: \"Bringing a baby sheep (or wolf?) back home\",\n        source: \"/images/minting.gif\"\n      }],\n      modalIsOpen: !!transacting\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(OutcomeModal, {\n      outcomes: outcomes,\n      modalIsOpen: outcomes.length > 0,\n      closeModal: () => {\n        setOutcomes([]);\n        reload();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 208,\n    columnNumber: 9\n  }, this);\n};\n_s(Minting, \"0MhdABEbY2wvZlM6yHi72Nnh8e0=\");\n_c = Minting;\nexport default Minting;\nvar _c;\n$RefreshReg$(_c, \"Minting\");","map":{"version":3,"names":["useState","WoodButton","Container","MintProgress","LoadingModal","OutcomeModal","EthereumInteraction","mint","mintWithJoe","mintWithTractor","parseMint","approve","watchTransaction","decodeTokenURI","utils","BigNumber","jsxDEV","_jsxDEV","PLACEHOLDER","MINT_PRICE","TRACTOR_PRICE","JOE_PRICE","PAY_WITH","AVAX","TRACTOR","JOE","paymentOptions","id","title","Minting","wallet","chain","stats","reload","woolBalance","_s","amount","setAmount","loading","setLoading","transacting","setTransacting","error","setError","outcomes","setOutcomes","setMintingAndStaking","paymentToken","setPaymentToken","onPaymentToken","e","target","onMint","stake","hash","requiresEth","process","env","REACT_APP_WOOLF","receipt","success","results","setTimeout","presentOutcomes","console","log","o","i","tokenId","recipient","u","stolen","toLowerCase","shortRecipient","slice","push","message","toString","source","image","link","linkMessage","totalMinted","parseInt","totalSupply","maxTokens","ethCost","formatUnits","parseUnits","mul","from","tractorCost","joeCost","woolCost","totalWoolCost","total","currentId","preCheck","undefined","gt","children","className","fileName","_jsxFileName","lineNumber","columnNumber","minted","style","height","src","alt","minWidth","onClick","Math","max","min","width","fontSize","loadingScenes","modalIsOpen","length","closeModal","_c","$RefreshReg$"],"sources":["/Users/krishna/Documents/Projects/sheep-game/src/components/Minting.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport WoodButton from \"./WoodButton\";\nimport Container from \"./Container\";\nimport MintProgress from \"./MintProgress\";\nimport LoadingModal from \"./LoadingModal\";\nimport OutcomeModal from \"./OutcomeModal\";\nimport EthereumInteraction from \"./EthereumInteraction\";\nimport { mint, mintWithJoe, mintWithTractor, parseMint } from \"../utils/woolf\";\nimport { approve } from \"../utils/erc20\";\n// import { mint, parseMint, tokenURI, isInvalidWoolf } from '../utils/woolf'\nimport { watchTransaction } from \"../utils/ethereum\";\n// import { decodeTokenURI, isSheep } from '../utils/uri'\nimport { decodeTokenURI } from \"../utils/uri\";\n// import MintNStakeModal from './MintNStakeModal'\nimport { utils, BigNumber } from \"ethers\";\n\n// todo: change these prices in woolf.js as well\nconst PLACEHOLDER =\n    \"data:application/json;base64,eyJuYW1lIjogIldvbGYgIzI5IiwgImRlc2NyaXB0aW9uIjogIlRob3VzYW5kcyBvZiBTaGVlcCBhbmQgV29sdmVzIGNvbXBldGUgb24gYSBmYXJtIGluIHRoZSBtZXRhdmVyc2UuIEEgdGVtcHRpbmcgcHJpemUgb2YgJFdPT0wgYXdhaXRzLCB3aXRoIGRlYWRseSBoaWdoIHN0YWtlcy4gQWxsIHRoZSBtZXRhZGF0YSBhbmQgaW1hZ2VzIGFyZSBnZW5lcmF0ZWQgYW5kIHN0b3JlZCAxMDAlIG9uLWNoYWluLiBObyBJUEZTLiBOTyBBUEkuIEp1c3QgdGhlIEF2YWxhbmNoZSBibG9ja2NoYWluLiIsICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBEOTRiV3dnZG1WeWMybHZiajBpTVM0d0lpQmxibU52WkdsdVp6MGlhWE52TFRnNE5Ua3RNU0kvUGcwS1BDRXRMU0JIWlc1bGNtRjBiM0k2SUVGa2IySmxJRWxzYkhWemRISmhkRzl5SURFNExqRXVNU3dnVTFaSElFVjRjRzl5ZENCUWJIVm5MVWx1SUM0Z1UxWkhJRlpsY25OcGIyNDZJRFl1TURBZ1FuVnBiR1FnTUNrZ0lDMHRQZzBLUEhOMlp5QjJaWEp6YVc5dVBTSXhMakVpSUdsa1BTSkRZWEJoWHpFaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJZ2VHMXNibk02ZUd4cGJtczlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1RrdmVHeHBibXNpSUhnOUlqQndlQ0lnZVQwaU1IQjRJZzBLQ1NCMmFXVjNRbTk0UFNJd0lEQWdNeklnTXpJaUlITjBlV3hsUFNKbGJtRmliR1V0WW1GamEyZHliM1Z1WkRwdVpYY2dNQ0F3SURNeUlETXlPeUlnZUcxc09uTndZV05sUFNKd2NtVnpaWEoyWlNJK0RRbzhaejROQ2drOFp5QnBaRDBpY1hWbGMzUnBiMjVmZURWR1gyMWhjbXNpUGcwS0NRazhaejROQ2drSkNUeHdZWFJvSUhOMGVXeGxQU0ptYVd4c09pTXdNekF4TURRN0lpQmtQU0pOTVRjdU5pd3pNR013TERFdU1UQXlMVEF1T0RrMUxESXRNaXd5Y3kweUxUQXVPRGs0TFRJdE1tTXdMVEV1TVRBNUxEQXVPRGsxTFRJc01pMHlVekUzTGpZc01qZ3VPRGt4TERFM0xqWXNNekI2SWk4K0RRb0pDUWs4Y0dGMGFDQnpkSGxzWlQwaVptbHNiRG9qTURNd01UQTBPeUlnWkQwaVRURTFMalkzTml3eU5TNDVOemRqTFRFdU16TTJMREF0TWk0MU9TMHdMalV5TXkwekxqVXpOUzB4TGpRMk9XTXRNQzQ1TkRVdE1TNHhNRFV0TVM0ME5qVXRNaTR6TlRrdE1TNDBOalV0TXk0Mk9UVU5DZ2tKQ1Fsek1DNDFNaTB5TGpVNUxERXVORFkxTFRNdU16Y3hiRFl1TmpnNExUWXVOamc0UXpFNUxqVTROQ3c1TGprNU5pd3lNQ3c0TGprNU1pd3lNQ3czTGpreU5tTXdMVEV1TURjdE1DNDBNVFl0TWk0d056UXRNUzR4TnpJdE1pNDRNamdOQ2drSkNRbGpMVEV1TlRVNUxURXVOVFU1TFRRdU1EazJMVEV1TlRZeUxUVXVOalUwTERCRE1USXVOREUyTERVdU9EVXlMREV5TERZdU9EVTFMREV5TERjdU9USTJTRGhqTUMweUxqRXpOeXd3TGpnek5DMDBMakUwT0N3eUxqTTBPQzAxTGpZMkRRb0pDUWtKWXpNdU1ESXRNeTR3TWpNc09DNHlPRFV0TXk0d01pd3hNUzR6TURrc01DNHdNRFJETWpNdU1UWTRMRE11TnpjM0xESTBMRFV1TnpnMUxESTBMRGN1T1RJMll6QXNNaTR4TXpjdE1DNDRNeklzTkM0eE5EVXRNaTR6TkRRc05TNDJOVFpzTFRZdU5qZzRMRFl1TlRJekRRb0pDUWtKWXkwd0xqTTRPU3d3TGpNNU1TMHdMak00T1N3eExqQXlNeXd3TERFdU5ERTBZekF1TXpreExEQXVNemt4TERFdU1ESXpMREF1TXpreExERXVOREUwTERCak1DNHlOVFF0TUM0eU5UZ3NNQzR5T1RNdE1DNDFOVFVzTUM0eU9UTXRNQzQzTVRGb05BMEtDUWtKQ1dNd0xERXVNek0yTFRBdU5USXNNaTQxT1RRdE1TNDBOalVzTXk0Mk9UbERNVGd1TWpZMkxESTFMalExTXl3eE55NHdNVElzTWpVdU9UYzNMREUxTGpZM05pd3lOUzQ1TnpkTU1UVXVOamMyTERJMUxqazNOM29pTHo0TkNna0pQQzluUGcwS0NUd3ZaejROQ2p3dlp6NE5DanhuUGcwS1BDOW5QZzBLUEdjK0RRbzhMMmMrRFFvOFp6NE5Dand2Wno0TkNqeG5QZzBLUEM5blBnMEtQR2MrRFFvOEwyYytEUW84Wno0TkNqd3ZaejROQ2p4blBnMEtQQzluUGcwS1BHYytEUW84TDJjK0RRbzhaejROQ2p3dlp6NE5DanhuUGcwS1BDOW5QZzBLUEdjK0RRbzhMMmMrRFFvOFp6NE5Dand2Wno0TkNqeG5QZzBLUEM5blBnMEtQR2MrRFFvOEwyYytEUW84Wno0TkNqd3ZaejROQ2p3dmMzWm5QZzBLIiwgImF0dHJpYnV0ZXMiOlt7InRyYWl0X3R5cGUiOiJGdXIiLCJ2YWx1ZSI6IkdyYXkifSx7InRyYWl0X3R5cGUiOiJIZWFkIiwidmFsdWUiOiJCZXRhIn0seyJ0cmFpdF90eXBlIjoiRXllcyIsInZhbHVlIjoiQ2xvc2VkIn0seyJ0cmFpdF90eXBlIjoiTW91dGgiLCJ2YWx1ZSI6IlNtaXJrIn0seyJ0cmFpdF90eXBlIjoiTmVjayIsInZhbHVlIjoiVGllIn0seyJ0cmFpdF90eXBlIjoiQWxwaGEgU2NvcmUiLCJ2YWx1ZSI6IjcifSx7InRyYWl0X3R5cGUiOiJHZW5lcmF0aW9uIiwidmFsdWUiOiJHZW4gMCJ9LHsidHJhaXRfdHlwZSI6IlR5cGUiLCJ2YWx1ZSI6IldvbGYifV19\";\nconst MINT_PRICE = \"2\";\nconst TRACTOR_PRICE = \"32000\";\nconst JOE_PRICE = \"62\";\nconst PAY_WITH = {\n    AVAX: \"AVAX\",\n    TRACTOR: \"TRACTOR\",\n    JOE: \"JOE\",\n};\n\nconst paymentOptions = [\n    { id: PAY_WITH.AVAX, title: \"AVAX\" },\n    { id: PAY_WITH.TRACTOR, title: \"TRACTOR\" },\n    { id: PAY_WITH.JOE, title: \"JOE\" },\n];\n\nconst Minting = ({ wallet, chain, stats, reload, woolBalance }) => {\n    const [amount, setAmount] = useState(1);\n    const [loading, setLoading] = useState(false);\n    const [transacting, setTransacting] = useState(false);\n    const [error, setError] = useState(null);\n    const [outcomes, setOutcomes] = useState([]);\n    // const [mintingAndStaking, setMintingAndStaking] = useState(false)\n    const [, setMintingAndStaking] = useState(false);\n    const [paymentToken, setPaymentToken] = useState(PAY_WITH.AVAX);\n\n    const onPaymentToken = (e) => {\n        setPaymentToken(e.target.id);\n    };\n\n    const onMint = async (stake) => {\n        setLoading(true);\n        setError(null);\n        try {\n            let hash;\n\n            if (paymentToken === PAY_WITH.AVAX) {\n                hash = (await mint(stake, amount, requiresEth())).hash;\n            } else if (paymentToken === PAY_WITH.TRACTOR) {\n                await approve(\"0x542fa0b261503333b90fe60c78f2beed16b7b7fd\", process.env.REACT_APP_WOOLF);\n                hash = (await mintWithTractor(amount)).hash;\n            } else if (paymentToken === PAY_WITH.JOE) {\n                await approve(\"0x6e84a6216ea6dacc71ee8e6b0a5b7322eebc0fdd\", process.env.REACT_APP_WOOLF);\n                hash = (await mintWithJoe(amount)).hash;\n            } else {\n                return;\n            }\n\n            setTransacting(true);\n            setMintingAndStaking(false);\n\n            watchTransaction(hash, (receipt, success) => {\n                if (!success) {\n                    setLoading(false);\n                    setTransacting(false);\n                    return setError(\"Mint failed. Check transaction.\");\n                }\n\n                const results = parseMint(stake, receipt);\n\n                setTimeout(async () => {\n                    await presentOutcomes(results);\n                    setLoading(false);\n                    setTransacting(false);\n                }, 2000);\n            });\n        } catch (e) {\n            console.log(e);\n            setLoading(false);\n        }\n    };\n\n    // const delay = (time) => {\n    //   return new Promise(res => setTimeout(res, time))\n    // }\n\n    // const getWoolf = async (tokenId) => {\n    //   try {\n    //     let u = await tokenURI(tokenId)\n    //     while (isInvalidWoolf(decodeTokenURI(u))) {\n    //       console.log('RETRYING')\n    //       await delay(1000)\n    //       u = await tokenURI(tokenId)\n    //     }\n    //     return u\n    //   } catch (e) {\n    //     console.log('READ FAILED. RETRYING')\n    //     return getWoolf(tokenId)\n    //   }\n    // }\n\n    const presentOutcomes = async (results) => {\n        const o = [];\n        for (let i in results) {\n            // const { tokenId, recipient, stake } = results[i]\n            const { tokenId, recipient } = results[i];\n\n            // let u = await getWoolf(tokenId)\n            let u = PLACEHOLDER;\n\n            const stolen = recipient.toLowerCase() !== wallet.toLowerCase();\n\n            if (stolen) {\n                const shortRecipient = `${recipient.slice(0, 6)}...${recipient.slice(-4)}`;\n                o.push(\n                    {\n                        message: `You minted a sheep or a woolf #${tokenId.toString()} BUT...`,\n                        source: decodeTokenURI(u).image,\n                        link: \"\",\n                        linkMessage: \"\",\n                    },\n                    {\n                        message: `It was stolen by a Wolf! It's now owned by ${shortRecipient}`,\n                        source: \"/images/mint-stolen.gif\",\n                    }\n                );\n            } else {\n                // * og\n                // o.push({\n                //   message:`You arrived safely at home with ${isSheep(u) ? 'Sheep' : 'Wolf'} #${tokenId.toString()}...`,\n                //   source: decodeTokenURI(u).image,\n                //   link:`${process.env.REACT_APP_OPENSEA}/${process.env.REACT_APP_WOOLF}/${tokenId.toString()}`,\n                //   linkMessage:'View on OpenSea'\n                // })\n                o.push({\n                    message: `You arrived safely at home with a sheep or a woolf #${tokenId.toString()}...`,\n                    source: decodeTokenURI(u).image,\n                    link: \"\",\n                    linkMessage: \"\",\n                });\n            }\n        }\n        setOutcomes(o);\n    };\n\n    const totalMinted = () => {\n        if (!stats) return 0;\n        // return parseInt(stats.sheepMinted) + parseInt(stats.wolvesMinted)\n        return parseInt(stats.totalSupply);\n    };\n\n    const maxTokens = () => {\n        if (!stats) return 50000;\n        return stats.maxTokens;\n    };\n\n    const requiresEth = () => {\n        if (!stats) return true;\n        return totalMinted() < parseInt(stats.maxTokens) / 5;\n    };\n\n    const ethCost = () => {\n        return utils.formatUnits(utils.parseUnits(MINT_PRICE, \"gwei\").mul(BigNumber.from(amount)), \"gwei\") + \" AVAX\";\n    };\n\n    const tractorCost = () => {\n        return utils.formatUnits(utils.parseUnits(TRACTOR_PRICE, \"gwei\").mul(BigNumber.from(amount)), \"gwei\") + \" TRACTOR\";\n    };\n\n    const joeCost = () => {\n        return utils.formatUnits(utils.parseUnits(JOE_PRICE, \"ether\").mul(BigNumber.from(amount)), \"ether\") + \" JOE\";\n    };\n\n    const woolCost = (tokenId) => {\n        if (!stats) return 0;\n        let maxTokens = parseInt(stats.maxTokens);\n        if (tokenId <= (maxTokens * 2) / 5) return 20000;\n        if (tokenId <= (maxTokens * 4) / 5) return 40000;\n        return 80000;\n    };\n\n    const totalWoolCost = () => {\n        if (!stats) return 0;\n        let total = 0;\n        let currentId = totalMinted();\n        for (let i = 1; i <= amount; i++) {\n            total += woolCost(currentId + i);\n        }\n        return total;\n    };\n\n    const preCheck = () => {\n        if (requiresEth()) return undefined;\n        if (!woolBalance || woolBalance === \"?\") return \"Insufficient $aWOOL\";\n        if (utils.parseUnits(\"\" + totalWoolCost(), \"gwei\").gt(woolBalance)) return \"Insufficient $aWOOL\";\n        return undefined;\n    };\n\n    return (\n        <Container>\n            <div className=\"flex flex-col items-center font-pixel gap-5\">\n                <div className=\"subtitle mt-5\">MINTING</div>\n                <MintProgress minted={totalMinted()} maxTokens={maxTokens()} />\n                <div className=\"mt-2\"></div>\n\n                {totalMinted() >= maxTokens() ? (\n                    <div className=\"text-red text-2xl\">Sold out!</div>\n                ) : (\n                    <EthereumInteraction wallet={wallet} chain={chain}>\n                        <div className=\"flex justify-center items-center gap-2\" style={{ height: \"50px\" }}>\n                            <div className=\"font-console text-lg pt-2 mr-3\">Amount</div>\n                            <img\n                                src=\"/images/arrow-down.svg\"\n                                alt=\"decrease\"\n                                className=\"cursor-pointer\"\n                                style={{ minWidth: \"25px\" }}\n                                onClick={() => {\n                                    setAmount(Math.max(1, amount - 1));\n                                }}\n                            />\n                            <div className=\"font-console text-red text-3xl pt-2\">{amount}</div>\n                            <img\n                                src=\"/images/arrow-up.svg\"\n                                alt=\"decrease\"\n                                className=\"cursor-pointer\"\n                                style={{ minWidth: \"25px\" }}\n                                onClick={() => {\n                                    setAmount(Math.min(10, amount + 1));\n                                }}\n                            />\n                        </div>\n                        <div className=\"mb-2\">\n                            Cost:\n                            <br />\n                            <span className=\"text-red\">{requiresEth() ? ethCost() : `${totalWoolCost()} $aWOOL`}</span>\n                            <br />\n                            {requiresEth() && (\n                                <span>\n                                    <span className=\"text-red\"> {tractorCost()} </span>&nbsp; or\n                                    <br />\n                                </span>\n                            )}\n                            {requiresEth() && (\n                                <span>\n                                    <span className=\"text-red\"> {joeCost()} </span>\n                                    <br />\n                                </span>\n                            )}\n                        </div>\n                        {preCheck() ? (\n                            <div className=\"text-red text-2xl\">{preCheck()}</div>\n                        ) : (\n                            <div className=\"flex xl:flex-row flex-col justify-center items-center gap-5\">\n                                <div className=\"flex flex-col justify-center items-center\">\n                                    <WoodButton\n                                        width={250}\n                                        height={40}\n                                        title={\"MINT\"}\n                                        fontSize={20}\n                                        loading={loading}\n                                        onClick={() => {\n                                            onMint(false);\n                                        }}\n                                    />\n                                    {/* <span className=\"mt-4\">WITH</span>\n                  <fieldset className=\"mt-4\">\n                    <legend className=\"sr-only\">Notification method</legend>\n                    <div className=\"space-y-4 sm:flex sm:items-center sm:space-y-0 sm:space-x-10\">\n                      {paymentOptions.map((paymentOption) => (\n                        <div\n                          key={paymentOption.id}\n                          className=\"flex items-center\"\n                        >\n                          <input\n                            id={paymentOption.id}\n                            name=\"notification-method\"\n                            type=\"radio\"\n                            defaultChecked={paymentOption.id === PAY_WITH.AVAX}\n                            className=\"focus:ring-black h-4 w-4 text-balck border-black\"\n                            onClick={onPaymentToken}\n                          />\n                          <label\n                            htmlFor={paymentOption.id}\n                            className=\"ml-3 block text-sm font-medium text-black\"\n                          >\n                            {paymentOption.title}\n                          </label>\n                        </div>\n                      ))}\n                    </div>\n                  </fieldset> */}\n                                    <div className=\"mt-2\" style={{ height: \"20px\" }}></div>\n                                </div>\n                                {/* <div className=\"flex flex-col justify-center items-center\">\n                  <WoodButton width={250} height={40} title={'MINT & STAKE'} fontSize={20} loading={loading} onClick={() => {\n                    setMintingAndStaking(true)\n                  }}/>\n                  <div className=\"font-console text-xs mt-2 text-center\" style={{height:'20px'}}>\n                    (saves gas)\n                  </div>\n                </div> */}\n                            </div>\n                        )}\n\n                        {error && <div className=\"text-sm text-red font-console\">{error}</div>}\n                    </EthereumInteraction>\n                )}\n            </div>\n            <LoadingModal\n                loadingScenes={[\n                    {\n                        message: \"Bringing a baby sheep (or wolf?) back home\",\n                        source: \"/images/minting.gif\",\n                    },\n                ]}\n                modalIsOpen={!!transacting}\n            />\n            <OutcomeModal\n                outcomes={outcomes}\n                modalIsOpen={outcomes.length > 0}\n                closeModal={() => {\n                    setOutcomes([]);\n                    reload();\n                }}\n            />\n        </Container>\n    );\n};\n\nexport default Minting;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}